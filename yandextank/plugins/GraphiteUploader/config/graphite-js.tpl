<html>
    <head>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
        <script src="http://code.highcharts.com/highcharts.js"></script>
        <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
        <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">
        <script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
        <script type="text/javascript">
(function(){var e,t,i,a;t=["#E67117","#8F623F","#6D3103","#F9AA6D","#F9CFB0","#E69717","#8F713F","#6D4403","#F9C36D","#F9DDB0","#1A5197","#2E435E","#032148","#6FA3E5","#A8C2E5","#0E8D84","#275855","#02433E","#63E3D9","#A0E3DE"],i={spline:{lineWidth:2,states:{hover:{lineWidth:4}},marker:{enabled:!1}}},a=[{name:"Quantiles",targets:[{metric:"%p.overall.quantiles.100_0","function":"aliasByMetric(%m)"},{metric:"%p.overall.quantiles.99_0","function":"aliasByMetric(%m)"},{metric:"%p.overall.quantiles.95_0","function":"aliasByMetric(%m)"},{metric:"%p.overall.quantiles.90_0","function":"aliasByMetric(%m)"},{metric:"%p.overall.quantiles.75_0","function":"aliasByMetric(%m)"},{metric:"%p.overall.quantiles.50_0","function":"aliasByMetric(%m)"}],chartType:"area",colors:["green","#38DD00","#A6DD00","#DDDC00","#DD6e00","#DD3800","#DD0000"],plotOptions:{area:{lineWidth:0,stacking:"normal",marker:{enabled:!1}}}},{name:"RPS by marker",targets:[{metric:"%p.markers.*.RPS"},{metric:"%p.overall.RPS"}]},{name:"Average response time by marker",targets:[{metric:"%p.overall.avg_response_time","function":"aliasByNode(%m, 2)"},{metric:"%p.markers.*.avg_response_time","function":"aliasByNode(%m, 3)"}]},{name:"HTTP codes",targets:[{metric:"%p.overall.http_codes.*","function":"aliasByMetric(%m)"}],chartType:"area",plotOptions:{area:{lineWidth:0,stacking:"normal",marker:{enabled:!1}}}},{name:"NET codes",targets:[{metric:"%p.overall.net_codes.*","function":"aliasByMetric(%m)"}],chartType:"area",plotOptions:{area:{lineWidth:0,stacking:"normal",marker:{enabled:!1}}}},{name:"Cumulative quantiles",targets:[{metric:"%p.cumulative.quantiles.100_0","function":"aliasByMetric(%m)"},{metric:"%p.cumulative.quantiles.99_0","function":"aliasByMetric(%m)"},{metric:"%p.cumulative.quantiles.95_0","function":"aliasByMetric(%m)"},{metric:"%p.cumulative.quantiles.90_0","function":"aliasByMetric(%m)"},{metric:"%p.cumulative.quantiles.75_0","function":"aliasByMetric(%m)"},{metric:"%p.cumulative.quantiles.50_0","function":"aliasByMetric(%m)"}],chartType:"area",colors:["green","#38DD00","#A6DD00","#DDDC00","#DD6e00","#DD3800","#DD0000"],plotOptions:{area:{lineWidth:0,stacking:"normal",marker:{enabled:!1}}}}],function(e,t){var i,a;e&&(i=e.Chart.prototype,a=e.Legend.prototype,e.extend(i,{legendSetVisibility:function(e){var n,r,o,l,s,c,p,m;if(n=this,o=n.legend,c=void 0,l=void 0,s=void 0,p=n.options.legend,m=void 0,r=void 0,p.enabled!==e){if(p.enabled=e,!e){if(a.destroy.call(o),c=o.allItems)for(l=0,s=c.length;s>l;)c[l].legendItem=t,++l;o.group={}}i.render.call(n),p.floating||(m=n.scroller,m&&m.render&&(r=n.xAxis[0].getExtremes(),m.render(r.min,r.max)))}},legendHide:function(){this.legendSetVisibility(!1)},legendShow:function(){this.legendSetVisibility(!0)},legendToggle:function(){this.legendSetVisibility(this.options.legend.enabled^!0)}}))}(Highcharts),e=function(){function e(e,t){var i,a,n=this;this.template=t,i=$("      <button class='btn'>            <span class='glyphicon glyphicon-list' />      </button>    "),i.click(function(){return n.chart?n.chart.legendToggle():void 0}),this.container=$("<div />",{title:this.template.name}),a=$("<div />"),i.appendTo(a),this.container.appendTo(a),a.appendTo(e),this.params=$(e).data(),this.options={format:"json",tz:"Europe/Moscow",maxDataPoints:500,from:this.params.startTime,until:this.params.endTime}}return e.prototype._makeOptions=function(){var e,t;return function(){var i,a;i=this.options,a=[];for(e in i)t=i[e],a.push(""+e+"="+t);return a}.call(this).join("&")},e.prototype._createTimeSeries=function(e){var t,i,a,n,r;for(r=[],a=0,n=e.length;n>a;a++)t=e[a],r.push({name:t.target,data:function(){var e,a,n,r;for(n=t.datapoints,r=[],e=0,a=n.length;a>e;e++)i=n[e],r.push([1e3*i[1],i[0]]);return r}()});return r},e.prototype._makeTarget=function(e){var t;return t=e.metric.replace("%p",this.params.prefix),null!=e["function"]&&(t=e["function"].replace("%m",t)),t},e.prototype._query=function(){var e;return function(){var t,i,a,n;for(a=this.template.targets,n=[],t=0,i=a.length;i>t;t++)e=a[t],n.push("target="+this._makeTarget(e));return n}.call(this).join("&")+"&"+this._makeOptions()},e.prototype._update=function(){var e,a=this;return e="http://"+this.params.host+":"+this.params.webPort+"/render?"+this._query(),$(this.container).attr("src",e),$.ajax(e).done(function(e){return a.chart=new Highcharts.Chart({title:{text:a.template.name,x:-20},xAxis:{title:{text:"Time"},type:"datetime"},yAxis:{title:{text:"Value"},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{crosshairs:!0},chart:{type:a.template.chartType||"spline",zoomType:"xy",renderTo:$(a.container)[0]},plotOptions:a.template.plotOptions||i,colors:a.template.colors||t,legend:{layout:"vertical",align:"center",verticalAlign:"bottom",borderWidth:0},series:a._createTimeSeries(e)}),a.chart.legendHide()})},e}(),$(document).ready(function(){return $(".graphite-charts").each(function(){var t,i,n,r;for(r=[],i=0,n=a.length;n>i;i++)t=a[i],t.chart=new e(this,t),r.push(t.chart._update());return r})})}).call(this);
        </script>
    </head>
    <body>
        <div class="graphite-charts" data-host="$host" data-web-port="$web_port" data-start-time="$start_time" data-end-time="$end_time" data-prefix="$prefix" />
    <body>
<html>